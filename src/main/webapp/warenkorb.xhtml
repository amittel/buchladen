<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core">

    <ui:composition template="WEB-INF/template/mytemplate.xhtml">
        <ui:define name="content">
            <h1>Warenkorb</h1>
            <h:form id="buch">
                <h:dataTable 
                    id="warenkorb"

                    styleClass="table table-striped table-hover table-bordered"
                    value="#{warenkorbBean.items}" var="pitem">

                    <h:column>
                        <f:facet name="header">Buchtitel</f:facet>
                        <h:outputText value="#{pitem.book.BName}"/>
                    </h:column>                    
                    <h:column>
                        <f:facet name="header">Einzelpreis</f:facet>
                        <h:outputText value="#{pitem.book.BPreis}"/>
                    </h:column>                                      
                    <h:column>
                        <f:facet name="header">Menge</f:facet> 
                        
                        <h:commandButton 
                            value="-" 
                            action="#{warenkorbBean.updateNumberOfItemDecrease(pitem, abc.value)}" 
                            class="btn btn-primary">
                            
                            <f:ajax event="click"  render="anzahlID"/>
                        </h:commandButton>
                        
                        <h:outputText  
                            id="anzahlID" 
                            binding="#{abc}" 
                            value="#{pitem.numberOfItems}"
                            >
                        </h:outputText>                        
                  
                        <h:commandButton value="+" 
                                         action="#{warenkorbBean.updateNumberOfItemIncrease(pitem, abc.value)}" 
                                         class="btn btn-primary">
                            <f:ajax event="click"  render="anzahlID"/>
                        </h:commandButton>
                        
                    </h:column>
                    <h:column>
                        <f:facet name="header">Gesamtpreis</f:facet>
                        <h:outputText id="gesamtpreis" value="#{pitem.book.BPreis * pitem.numberOfItems}"/>
                    </h:column> 
                </h:dataTable>
            </h:form>

            
            <h:panelGrid
                id="gesamtpreis-tbl"
                styleClass="table table-striped table-hover table-bordered">

                <h:column>
                    <f:facet name="header">Gesamtpreis</f:facet>
                    <h:outputText value="#{warenkorbBean.totalSum}"/>
                </h:column> 
            </h:panelGrid>

            
            <h:form>
                <h:button value="Bestellen!" outcome="bestellen.xhtml" class="btn btn-primary"/>
            </h:form>

        </ui:define>
    </ui:composition> 
</html>

